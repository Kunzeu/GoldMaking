<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Editar Farmeo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body x-data="{ sidebarOpen: (localStorage.getItem('sidebarOpen') === null ? true : localStorage.getItem('sidebarOpen') === 'true') }" x-init="
    $watch('sidebarOpen', value => localStorage.setItem('sidebarOpen', value));
" class="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-blue-900 font-sans text-lg text-gray-900 flex">
    <!-- Sidebar -->
    <aside :class="sidebarOpen ? 'w-56' : 'w-20'" class="h-screen bg-gray-900/90 text-white flex flex-col transition-all duration-300 shadow-lg z-50 fixed left-0 top-0">
        <div class="flex items-center justify-between px-4 py-4 border-b border-gray-800">
            <span class="flex items-center gap-2" x-show="sidebarOpen">
                <svg class="w-7 h-7 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="10" stroke-width="2" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h8m-4-4v8" /></svg>
                <span class="font-bold text-yellow-400 text-xl tracking-tight transition-all">Gold <span class="text-white">Making</span></span>
            </span>
            <button @click="sidebarOpen = !sidebarOpen" class="focus:outline-none ml-2">
                <svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
            </button>
        </div>
        <nav class="flex-1 py-4 flex flex-col gap-2" x-show="sidebarOpen">
            <a href="{{ url_for('main.index') }}" @click="if(window.innerWidth<768){sidebarOpen=false}" class="flex items-center gap-3 px-4 py-2 hover:bg-indigo-800 rounded transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M13 5v6h6" /></svg>
                <span x-show="sidebarOpen" class="transition-all">Inicio</span>
            </a>
            <a href="{{ url_for('main.farms') }}" class="flex items-center gap-3 px-4 py-2 hover:bg-indigo-800 rounded transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span x-show="sidebarOpen" class="transition-all">Farms</span>
            </a>
            <a href="{{ url_for('main.daily_routine') }}" class="flex items-center gap-3 px-4 py-2 hover:bg-indigo-800 rounded transition-all">Daily Routine</a>
            <a href="{{ url_for('main.about') }}" @click="if(window.innerWidth<768){sidebarOpen=false}" class="flex items-center gap-3 px-4 py-2 hover:bg-indigo-800 rounded transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span x-show="sidebarOpen" class="transition-all">Acerca de</span>
            </a>
            <a href="{{ url_for('main.admin_panel') }}" @click="if(window.innerWidth<768){sidebarOpen=false}" class="flex items-center gap-3 px-4 py-2 hover:bg-indigo-800 rounded transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 21l3-1 3 1-.75-4M4 4h16v2a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" /></svg>
                <span x-show="sidebarOpen" class="transition-all">Panel Admin</span>
            </a>
            <a href="{{ url_for('main.users_panel') }}" @click="if(window.innerWidth<768){sidebarOpen=false}" class="flex items-center gap-3 px-4 py-2 hover:bg-indigo-800 rounded transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a4 4 0 00-3-3.87M9 20H4v-2a4 4 0 013-3.87M16 3.13a4 4 0 010 7.75M8 3.13a4 4 0 010 7.75" /></svg>
                <span x-show="sidebarOpen" class="transition-all">Usuarios</span>
            </a>
            <a href="{{ url_for('main.create_user') }}" @click="if(window.innerWidth<768){sidebarOpen=false}" class="flex items-center gap-3 px-4 py-2 hover:bg-indigo-800 rounded transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                <span x-show="sidebarOpen" class="transition-all">Crear usuario</span>
            </a>
            <a href="{{ url_for('main.add_farm') }}" @click="if(window.innerWidth<768){sidebarOpen=false}" class="flex items-center gap-3 px-4 py-2 hover:bg-indigo-800 rounded transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                <span x-show="sidebarOpen" class="transition-all">Añadir Farmeo</span>
            </a>
        </nav>
        <div class="px-4 py-4 border-t border-gray-800" x-show="sidebarOpen">
            <div class="mt-auto">
            {% if not current_user.is_authenticated %}
                <a href="{{ url_for('auth.login') }}" @click="if(window.innerWidth<768){sidebarOpen=false}" class="flex items-center gap-3 px-4 py-2 hover:bg-blue-700 rounded transition-all">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                    <span x-show="sidebarOpen" class="transition-all">Iniciar sesión</span>
                </a>
            {% else %}
                <div x-data="{ open: false }" class="relative">
                    <button @click="open = !open" class="flex items-center gap-3 px-4 py-2 w-full hover:bg-indigo-700 rounded transition-all focus:outline-none">
                        <svg class="w-6 h-6 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="10" stroke-width="2" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h8m-4-4v8" /></svg>
                        <span x-show="sidebarOpen" class="transition-all">{{ current_user.username }}</span>
                        <svg class="w-4 h-4 ml-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                    </button>
                    <div x-show="open" @click.away="open = false"
                        class="absolute bottom-0 left-full mb-2 w-48 bg-gray-800 rounded shadow-lg z-10">
                        <a href="{{ url_for('main.change_password') }}" class="block px-4 py-2 hover:bg-indigo-600 rounded transition-all">Cambiar contraseña</a>
                        <a href="{{ url_for('auth.logout') }}" class="block px-4 py-2 text-red-400 hover:bg-red-600 rounded transition-all">Cerrar sesión</a>
                    </div>
                </div>
            {% endif %}
            </div>
        </div>
    </aside>
    <!-- Contenido principal -->
    <div :class="sidebarOpen ? 'ml-56' : 'ml-20'" class="flex-1 transition-all duration-300">
        <div class="max-w-lg mx-auto mt-10 bg-white/80 backdrop-blur-md rounded-xl shadow-lg p-8 transition-shadow duration-500 hover:shadow-2xl">
            <div class="mb-4 flex justify-between items-center">
                <h1 class="text-3xl font-bold text-center text-indigo-900 drop-shadow">Editar Farmeo</h1>
                <a href="{{ url_for('main.admin_panel') }}" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-semibold transition">← Volver al panel</a>
            </div>
            <form method="POST" aria-label="Formulario para editar farmeo">
                <div class="mb-4">
                    <label class="block mb-1 font-semibold" for="nombre">Nombre</label>
                    <input type="text" id="nombre" name="nombre" value="{{ farm.nombre }}" required aria-required="true" aria-label="Nombre del farmeo"
                        class="w-full px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-blue-400 transition-all duration-300">
                </div>
                <div class="mb-4">
                    <label class="block mb-1 font-semibold" for="veces_realizadas">Veces Realizadas</label>
                    <input type="number" id="veces_realizadas" name="veces_realizadas" value="{{ farm.veces_realizadas }}" required aria-required="true" aria-label="Veces realizadas"
                        class="w-full px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-blue-400 transition-all duration-300">
                </div>
                <div class="mb-4">
                    <label class="block mb-1 font-semibold" id="ganancia-label">Ganancia Estimada</label>
                    <div class="flex space-x-2" aria-labelledby="ganancia-label">
                        <input 
                            type="number" 
                            id="gold"
                            name="gold" 
                            min="0" 
                            value="{{ farm.gold }}" 
                            required 
                            aria-label="Oro" aria-required="true"
                            class="w-1/3 px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-yellow-400 transition-all duration-300">
                        <input 
                            type="number" 
                            id="silver"
                            name="silver" 
                            min="0" max="99" 
                            value="{{ farm.silver }}" 
                            required 
                            aria-label="Plata" aria-required="true"
                            class="w-1/3 px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-yellow-400 transition-all duration-300">
                        <input 
                            type="number" 
                            id="copper"
                            name="copper" 
                            min="0" max="99" 
                            value="{{ farm.copper }}" 
                            required 
                            aria-label="Cobre" aria-required="true"
                            class="w-1/3 px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-yellow-400 transition-all duration-300">
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block mb-1 font-semibold" for="waypoint">Waypoint</label>
                    <input type="text" id="waypoint" name="waypoint" value="{{ farm.waypoint }}" aria-label="Waypoint" class="w-full px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-indigo-400 transition-all duration-300">
                </div>
                <div class="mb-4">
                    <label class="block mb-1 font-semibold" for="duracion">Duración</label>
                    <input type="text" id="duracion" name="duracion" value="{{ farm.duracion }}" pattern="^([0-1]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$" placeholder="hh:mm:ss" aria-label="Duración" class="w-full px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-indigo-400 transition-all duration-300">
                    <span class="text-xs text-gray-600">Formato: hh:mm:ss</span>
                </div>
                <div class="mb-4">
                    <label class="block mb-1 font-semibold" for="requerimientos">Requerimientos</label>
                    <input type="text" id="requerimientos" name="requerimientos" value="{{ farm.requerimientos }}" aria-label="Requerimientos" class="w-full px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-indigo-400 transition-all duration-300">
                </div>
                <div class="mb-4">
                    <label class="block mb-1 font-semibold" id="profit-hr-label">Profit/hr (G/S/C)</label>
                    <div class="flex space-x-2" aria-labelledby="profit-hr-label">
                        <input 
                            type="number" 
                            id="profit_hr_gold"
                            name="profit_hr_gold" 
                            min="0" 
                            value="{{ farm.profit_hr_gold if farm.profit_hr_gold is defined else '' }}" 
                            aria-label="Oro/hr"
                            class="w-1/3 px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-yellow-400 transition-all duration-300">
                        <input 
                            type="number" 
                            id="profit_hr_silver"
                            name="profit_hr_silver" 
                            min="0" max="99" 
                            value="{{ farm.profit_hr_silver if farm.profit_hr_silver is defined else '' }}" 
                            aria-label="Plata/hr"
                            class="w-1/3 px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-yellow-400 transition-all duration-300">
                        <input 
                            type="number" 
                            id="profit_hr_copper"
                            name="profit_hr_copper" 
                            min="0" max="99" 
                            value="{{ farm.profit_hr_copper if farm.profit_hr_copper is defined else '' }}" 
                            aria-label="Cobre/hr"
                            class="w-1/3 px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-yellow-400 transition-all duration-300">
                    </div>
                    <p class="text-sm text-gray-700 mt-1" id="profit-hr-desc">Ingrese el profit por hora en Gold, Silver y Copper.</p>
                </div>
                <div class="mb-4">
                    <label class="block mb-1 font-semibold" for="limitation">Limitación</label>
                    <input type="text" id="limitation" name="limitation" value="{{ farm.limitation }}" aria-label="Limitación" class="w-full px-4 py-2 border rounded focus:outline-none focus-visible:ring-4 focus-visible:ring-indigo-400 transition-all duration-300">
                </div>
                <div class="flex justify-between items-center">
                    <a href="{{ url_for('main.admin_panel') }}" class="text-blue-500 hover:underline focus:outline-none focus-visible:underline focus-visible:decoration-blue-500 focus-visible:decoration-2" aria-label="Volver al panel">← Volver</a>
                    <button type="submit" class="bg-gradient-to-r from-yellow-400 to-yellow-600 text-white px-4 py-2 rounded-lg shadow hover:from-yellow-500 hover:to-yellow-700 font-semibold transition-all duration-300 focus:outline-none focus-visible:ring-4 focus-visible:ring-yellow-300" aria-label="Actualizar farmeo">Actualizar</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Pie de página -->
    <footer class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-md shadow-inner border-t border-gray-200 dark:border-gray-800 mt-12">
      <div class="max-w-screen-xl mx-auto px-4 py-6 flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="flex items-center gap-2">
          <!-- Logo o icono -->
          <svg class="h-7 w-7 text-cyan-600 dark:text-cyan-300" fill="currentColor" viewBox="0 0 28 24" aria-hidden="true">
            <path d="M0.41 10.3847C1.14777 7.4194 2.85643 4.7861 5.2639 2.90424C7.6714 1.02234 10.6393 0 13.695 0C16.7507 0 19.7186 1.02234 22.1261 2.90424C24.5336 4.7861 26.2422 7.4194 26.98 10.3847H25.78C23.7557 10.3549 21.7729 10.9599 20.11 12.1147C20.014 12.1842 19.9138 12.2477 19.81 12.3047H19.67C19.5662 12.2477 19.466 12.1842 19.37 12.1147C17.6924 10.9866 15.7166 10.3841 13.695 10.3841C11.6734 10.3841 9.6976 10.9866 8.02 12.1147C7.924 12.1842 7.8238 12.2477 7.72 12.3047H7.58C7.4762 12.2477 7.376 12.1842 7.28 12.1147C5.6171 10.9599 3.6343 10.3549 1.61 10.3847H0.41ZM23.62 16.6547C24.236 16.175 24.9995 15.924 25.78 15.9447H27.39V12.7347H25.78C24.4052 12.7181 23.0619 13.146 21.95 13.9547C21.3243 14.416 20.5674 14.6649 19.79 14.6649C19.0126 14.6649 18.2557 14.416 17.63 13.9547C16.4899 13.1611 15.1341 12.7356 13.745 12.7356C12.3559 12.7356 11.0001 13.1611 9.86 13.9547C9.2343 14.416 8.4774 14.6649 7.7 14.6649C6.9226 14.6649 6.1657 14.416 5.54 13.9547C4.4144 13.1356 3.0518 12.7072 1.66 12.7347H0V15.9447H1.61C2.39051 15.924 3.154 16.175 3.77 16.6547C4.908 17.4489 6.2623 17.8747 7.65 17.8747C9.0377 17.8747 10.392 17.4489 11.53 16.6547C12.1468 16.1765 12.9097 15.9257 13.69 15.9447C14.4708 15.9223 15.2348 16.1735 15.85 16.6547C16.9901 17.4484 18.3459 17.8738 19.735 17.8738C21.1241 17.8738 22.4799 17.4484 23.62 16.6547ZM23.62 22.3947C24.236 21.915 24.9995 21.664 25.78 21.6847H27.39V18.4747H25.78C24.4052 18.4581 23.0619 18.886 21.95 19.6947C21.3243 20.156 20.5674 20.4049 19.79 20.4049C19.0126 20.4049 18.2557 20.156 17.63 19.6947C16.4899 18.9011 15.1341 18.4757 13.745 18.4757C12.3559 18.4757 11.0001 18.9011 9.86 19.6947C9.2343 20.156 8.4774 20.4049 7.7 20.4049C6.9226 20.4049 6.1657 20.156 5.54 19.6947C4.4144 18.8757 3.0518 18.4472 1.66 18.4747H0V21.6847H1.61C2.39051 21.664 3.154 21.915 3.77 21.915 4.908 23.1889 6.2623 23.6147 7.65 23.6147C9.0377 23.6147 10.392 23.1889 11.53 22.3947C12.1468 21.9165 12.9097 21.6657 13.69 21.6847C14.4708 21.6623 15.2348 21.9135 15.85 22.3947C16.9901 23.1884 18.3459 23.6138 19.735 23.6138C21.1241 23.6138 22.4799 23.1884 23.62 22.3947Z"/>
          </svg>
          <span class="font-semibold text-gray-900 dark:text-white text-lg">Gold Making</span>
        </div>
        <div class="flex gap-4">
          <a href="#" class="text-gray-500 hover:text-cyan-600 dark:hover:text-cyan-400" aria-label="GitHub">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/></svg>
          </a>
          <a href="#" class="text-gray-500 hover:text-cyan-600 dark:hover:text-cyan-400" aria-label="Discord">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276c-.598.3428-1.2205.6447-1.8733.8923a.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1835 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0957 2.1568 2.4189 0 1.3333-.9555 2.419-2.1569 2.419zm7.9748 0c-1.1835 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0957 2.1568 2.4189 0 1.3333-.946 2.419-2.1568 2.419z"/></svg>
          </a>
        </div>
        <div class="text-xs text-gray-500 dark:text-gray-400 text-center md:text-right">
          &copy; 2025 Gold Making. Todos los derechos reservados.
        </div>
      </div>
    </footer>
    <!-- Toast de notificaciones -->
    <div x-data="{ show: false, message: '', color: 'green' }" x-init='
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            show = true;
            message = `{{ messages[0][1] }}`;
            color = `{{ 'red' if messages[0][0] == 'error' else 'green' }}`;
            setTimeout(() => show = false, 4000);
        {% endif %}
        {% endwith %}'
        x-show="show"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0 translate-y-2"
        x-transition:enter-end="opacity-100 translate-y-0"
        x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        class="fixed top-6 right-6 z-50">
        <div :class="color === 'green' ? 'bg-green-500' : 'bg-red-500'" class="text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-4 min-w-[220px]">
            <span x-text="message"></span>
            <button @click="show = false" class="ml-2 text-white/80 hover:text-white">&times;</button>
        </div>
    </div>
</body>
</html>
